% --------------------------------------------------
% 
% This chapter is for Tristomo
% 
% --------------------------------------------------

\chapter{Conclusions}
\label{cha:conclusion}

\section{Bioinformatics approaches enhance microbial diversity assesment based on HTS data}
\label{concl:diversity}

   Main goal of this PhD project was to address on-going challenges 
   related to the bioinformatics analysis of HTS-oriented studies 
   as well as 
   to provide ways for the optimal exploitation of such data and of 
   the current knowledge that is linked to them. 

   The 16S rRNA gene has been used for decades as the golden standard for the 
   study of microbial communities. 
   It has been shown that the
   full-length 16S sequence
   combined with appropriate treatment of the 
   intragenomic copy variants 
   has the potential to provide taxonomic resolution of 
   bacterial communities even at the strain level~\citep{johnson_evaluation_2019}.
   However, when the region is chosen carefully 
   and a thorough alignment procedure is applied,
   even short short reads may return phylogenetic information 
   comparable with the one fron full-length 16S rRNA reads~\citep{jeraldo2011suitability}.
   This was also shown in Chapter~\ref{publ:swamp} as the 16S rRNA amplicon analysis 
   was in line with the taxonomy assignment of the shotgun reads. 

   Even if amplicon studies have proven themselves essential for the assessment of 
   microbial diversity, the bioinformatics analaysis in such studies, 
   usually comes with several issues; 
   with the lack of parameter tuning being among the most crucial ones. 
   As shown in Chapter~\ref{publ:pema} where mock communities were used to validate the PEMA results,
   it is parameter tuning that determines the 
   precision and recall scores in such analyses. 
   Sequencing mock communities along with the rest of the samples   
   allows the tuning of the bioinformatics analysis based on a known assemblage
   and thus, it enables parameter tuning based on the idiosyncracy of each particular experiment/study~\citep{bokulich2020measuring}.

   When studying a microbial community, non-prokaryotic species need to be considered too. 
   In that case, 16S rRNA is not the best marker to use; instead, several markers 
   have been used for different taxonomic groups. 
   Thus, several studies aiming at the biodiversity assessment of environmental samples, 
   make use of several markers and apparently, workflows supporting their analysis are vital. 
   As shown in Chapter~\ref{publ:pema}, the PEMA approach attempts to address this challenge 
   by supporting the analysis of several markers but also by
   supporting the semi-automatic analysis of any marker since training of the classifiers invoked
   with any local database is possible. 

   Moreover, it is also commonly known that pseudogenes as well as 
   nuclear mitochondrial pseudogenes (numts) can lead to several biases in such studies \citep{song2008many}.
   To address this challenge multiple computational efforts have been implemented~\citep{porter2021profile}
   This issue also applies for the case of Bacteria and Archaea and the 16S rRNA gene~\citep{pei2010diversity}
   even if it has been shown that bacterial pseudogenes have a great chance of being removed almost directly after their formation;
   so fast so as to be governed by a strictly neutral model of stochastic loss~\citep{kuo2010extinction}.
   As shown in Chapter~\ref{publ:darn}, a great part of the OTUs/ASVs retrieved from COI amplicon data
   may actually come from bacterial and/or archaeal taxa.
   Such approaches need to be merged in amplicon studies as an extra
   quality control but also to enable further investigation of the unassigned OTUs/ASVs. 
   In Chapter~\ref{publ:darn} is also shown the need for reference databases to also include non-target sequences 
   so they can distinguish actual hits. 

   However, there is still a major question regarding the microbial diversity assessment; 
   how could HTS methods be used to recognise novel taxa and their metabolic potential? 
   As shown in Chapter~\ref{publ:swamp}, the reconstruction of MAGs from shotgun metagenomics data
   may play a great role in the description of unknown and currently uncultivated taxa. 
   Such studies and their corresponding MAGs have enriched our knowledge on the tree of life to a great extent 
   over the last few years, uncovering several prokaryotic phyla, leading to 
   radical challenges on their taxonomy and the taxonomy scheme~\citep{parks_gtdb_2022}.
   Long-read sequencing technologies such as Nanopore and PacBio, have improved their accuracy to a great extent,
   offering high-quality, cutting-edge alternatives for testing hypotheses about microbiome structure 
   and functioning as well as assembly of eukaryote genomes from complex environmental DNA samples~\citep{tedersoo2021perspectives}.

\section{Containerization technologies and e-infrastructures provide the means for computational capacity and reproducibility} 
\label{concl:comput}
   
      As shown in Chapter~\ref{cha:hpc} the computing resources required for the analysis of several 
      microbiome studies may range from those covered by a personal computer to overwhelming the capacity
      of Tier-2 HPC facilities;
      this also applies for any biological topic using HTS data. 
      On top of that, as also shown in Chapter~\ref{cha:hpc}, the maintance of bioinformatics-oriented HPC facilities 
      comes with a great number of challenges. 
   
      % PIPELINES
      By encapsulating a software along with its dependencies in an isolated and easy to (re)install environment (container) 
      containerization addresses several of them at once.
      First, the distribution and the installation becomes now a straight-forward task, requiring only for a containerization technology 
      to be present on the facility.
      Second, versioning of the various software used is not an issue anymore as a container may either "save" a version from being obsolete
      in case it is strongly dependent on that, either keep track of the latest version of the encapsulated software. 
      Morevover, several versions of the same software may be part of different containers without any conficts.
      In addition, the creation and management of standardized workflows/pipelines is facilitated to a great extent. 
      Workflow tools such as 
      \href{https://github.com/common-workflow-language/common-workflow-language}{Common Workflow Language (CWL)}
      \footnote{\href{https://github.com/common-workflow-language/common-workflow-language}{https://github.com/common-workflow-language/common-workflow-language}}, 
      \href{https://snakemake.github.io}{Snakemake} 
      \footnote{\href{https://snakemake.github.io}{https://snakemake.github.io}}
      and 
      \href{https://www.nextflow.io}{Nextflow}
      \footnote{\href{https://www.nextflow.io}{https://www.nextflow.io}}
      have been proven of high value 
      in building such pipelines as they support the connection of multiple independent software.
      MGnify~\citep{mitchell2020mgnify} is a great example of this case. 
   
      However, more often than not, such workflows require major computing resources to analyse
      real-world microbiome data sets.
      To this end, HPC facilities and cloud solutions are required. 
      Therefore, efforts such as those discussed in Section~\ref{publ:pema} 
      for containerised tools such as the PEMA workflow~\citep{zafeiropoulos2020pema}
      to be integrated in e-infrustructures, are rather significant. 
      This way, reproducability is secured and analyses that cannot be performed in a personal computer
      is accessible to researches that have no access to local servers or HPCs. 
      Further insight on how to address computing-oriented challenges on the analysis of microbiome data
      are discused in~\citep{hu2022challenges}.  

\section{High quality metadata enable efficient exploitation of sequecning data in a meta-analysis level}
\label{concl:metadata}
   
      It is common knowledge that both shotgun and long-read metagenomics provide 
      high quality data enabling the study of real-world microbial communities even at the strain level~\citep{meyer2022critical}.
      However, these data are not fully exploited unless they come with thorough and standardized metadata;
      indicatively it has been shown that more than the 20\% of the metagenomes published between 2016 and 2019 
      were not even accessible~\citep{eckert2020every}.
      To address such challenges, community-driven initiatives can be of great importance~\citep{yilmaz2011minimum, 
      vangay2021microbiome, hu2022challenges}.
      Similar initiatives focusing on specific topics, e.g. protocols in the framework of the 
      Ocean Best Practices System~\citep{samuel2021towards}, are essential.

      FAIR principles have set a new era on how data are stored and ditributed. 
      Data and metadata provenance goes even further by allowing not only the reuse of the data, 
      but also keeping track of where the data came from, potential edits, 
      as well as of the analyses that are linked to those, both regarding their outcome and the analysis \textit{per se}. 
      Ensuring FAIR (meta)data could be considered as the first step of data integration~\citep{freire2008provenance, deelman2010metadata}.
      Nevertheless, (meta)data provenance and data integration share several challenges~\citep{cheney2009provenance}. 
   
      As shown in Section~\ref{cha:prego}, the higher the quality of the accompanying metadata, 
      the higher the confidence meta-analysis approaches may get. 
      Furthermore, metadata accompanying the analyses, i.e. the workflows and their implementation, can provide further 
      insight on the effect of the various softwares and databases used. 
      In general, community efforts to set best-practice for formal metadata description
      and their use for packaging research data with their accompanying metada 
      such as the one of
      \href{https://www.researchobject.org/ro-crate/}{RO-Crate} may have a great impact.  
      Focusing on the microbiome community, 
      further challenges need to be addressed to this end, 
      with taxonomy and nomenclature being among the most crucial ones. 
      The GTDB~\citep{parks_gtdb_2022} that provides \textit{a phylogenetically
      consistent and rank normalized genome-based taxonomy for prokaryotic genomes sourced from the NCBI Assembly database}
      combined with efforts such as those of \citeauthor{pallen2021next} to ensure valid names for novel taxa that 
      will keep being discovered over the next years, could play a great role on addressing this issue. 
      However, moving all the so-far knowledge in a specific format is far from easy. 
      At the same time, as discussed in~\ref{cha:prego}, bringing together data of different types can return great insight 
      by either generate hypotheses or further supporting hypotheses such as the one of~\citeauthor{pavloudi2017diversity} 
      on the potential use of various electron acceptors from the different strains present in different environmental types
      (see~\ref{subsec:envo-proc}).
      This becomes clearer considering that up to now only a small fraction of the microbial diversity has been 
      described and named (~$24,000$ species~\citep{parte2020list}) with almost $10,000$ of them to have done so, over the last 6 years
      (see~\href{https://lpsn.dsmz.de/statistics/figure/10}{LPSN statistics}
      \footnote{\href{https://lpsn.dsmz.de/statistics/figure/10}{https://lpsn.dsmz.de/statistics/figure/10}}
      ). 

      Moreover, linking the various ontologies related to a certain domain without loosing the 
      benefits of each of those, is essential for the community. 
      That means that efforts for mapping entities of an ontology or a database to those of others 
      sharing a common field, e.g., the Rhea reaction knowledgebase~\citep{bansal2022rhea},
      even if there is not a one-to-one relationship, will increase considerably their impact.  

      By addessing these challenges and by ensuring high quality metadata,
      data integration techniques will improve considerably. 
      Combined with machine learning techniques, such methods 
      can contribute the most in exploiting the
      full potential of the HTS data produced
      and the so-far knowledge
      for the utmost biological insights that can be drawn~\citep{noor2019biological}.

\section{Markov Chain Monte Carlo approaches enable flux sampling at the microbial community level}
\label{concl:fluxes}

   Metabolic modelling and genome-scale metabolic models in particular, 
   provide a great framework to study the genotype - phenotype relationship~\citep{lewis2012constraining}.
   Thus, it enables the investigation on how a species respond under changing environmental conditions 
   too~\citep{herrmann2019flux}. 
   Flux sampling on microbial GEMs has been proved the most valuable for 
   the identification of specific reactions that are transcriptionally regulated~\citep{Bordel10}
   or required under certain conditions for the species to survive~\citep{herrmann2019flux}.
   But also in the study of the variant by-produts produced by the different strains of a 
   species~\citep{scott2021metabolic}.

   As shown in Chapter~\ref{chap:dingo} 
   the higher the dimension of the polytope derived from a metabolic model, 
   the more challenging the sampling on its flux space gets.
   The dimension of a polytope derived from any single microbial GEM 
   is at least one order of magnitude lower than 
   the one from species such as \textit{H. sapiens}.
   However, in real-world microbial communities it is rare for a species to exist on its own.
   Based on~\cite{perez2016metabolic} there are various approaches for modelling a community as a whole,
   each coming with several pros and cons.
   As the \textit{lumped network} approach 
   neglects microbial diversity dynamics and the dynamics of their corresponding processes, 
   assuming a \textit{super-organism} where all species share the same reactions and exploit their environment 
   in the same way, 
   it cannot be used for the study of microbial interactions. 
   To this end, models that integrate a GEM for every species present, 
   taking into account the relative abundance of each species, 
   and also 
   support the exchange of compounds between each species and the environment are required~\citep{diener2020micom}. 
   Dynamic versions of such models also allow the 
   changes in the biomass concentrations of each individual species to be taken into account~\citep{zhuang2011genome}. 
   This way, ecological interactions can be inferred;
   illustratively,~\citeauthor{zhuang2011genome} demonstrated 
   how the concentration of acetate in the environment can define 
   whether \textit{Rhodoferax} or its competitor \textit{Geobacter} will survive. 
   Approaches like COMETS~\citep{dukovski2021metabolic} and MICOM 
   have been essential towards this direction. 
   However, flux sampling has not been merged yet to large-scale approaches 
   mostly because of the computational challenges that arise as the dimension of the polytope 
   that derives from a model increases.
   Therefore, approaches such as the MMCS algorithm desribed in 
   Chapter~\ref{chap:dingo} may benefit the community to this end.

\section{Hypersaline mats host a great range of novel taxa \& their functioning might be subject to anaplerotic reactions}
\label{conlc:mats}

   As discussed in Chapter~\ref{swamp:intro} hypersaline mats 
   have been studied to a great extent over the last decades.
   Several novel taxa have been identified for the first time in such environments. 
   It is well established that in such communities a certain organisation of 
   the taxa present are stratified~\citep{saghai2017unveiling}
   and that photosynthesis plays a great part for the mat communities as a total~\citep{oren_cyanobacteria_2015}. 

   Thanks to their geomorphological and biogeochemical heterogeneity
   they provide a profuse number of ecological niches for microorganisms
   leading to highly diverse communities multiple taxa of which have not yet recorded.
   This was demonstrated to a great extent in Chapter~\ref{swamp:intro} (see also Appendix~\ref{app:C})
   where more than 200 novel taxa have been found and about 65 of them have 
   been described, highlight also the potential of shotgun metagenomics. 

   In their study,~\citeauthor{lee_nacl-saturated_2018} demonstrated 
   that NaCl saturated environments can be considered 
   “thermodynamically moderate”, meaning they are capable of 
   active and complete element cycling  
   and thus they can be considered as self-sustaining systems.
   To that end and assuming 
   that sunlight is the sole energy source of the system, 
   primary production of organic matter 
   by oxygenic phototrophs is essential for the community to survive~\citep{meier_limitation_2021}. 
   That is further supported by the the fact that 
   despite the fact that oxygenic photosynthesis is thermodynamically possible 
   at high salt concentrations~\citep{oren_thermodynamic_2011}, 
   a kinetic inhibition of oxygenic photosynthesis 
   by decreased oxygen solubility has been observed~\citep{abed2007effect}.
   Thus, Cyanobacteria have been found to be fundamental in hypersaline 
   microbial mats; 
   even when their abundance is relatively lower  
   they are assumed to remain the major group of 
   primary producers~\citep{bolhuis_molecular_2014}.
   However, in the Tristomo marsh mats, several phototrophic 
   Proteobacteria were identified suggesting they also play a great part 
   in fueling the system. 
   To investigate what is actually the case, further studies are required (see Conlusion~\ref{chap:fut-work}).
   % Interestingly, based on our study (see Chapter~\ref{publ:swamp}), 
   % in the Tristomo marsh mats 
   % it is mainly representatives of the Proteobacteria phylum that have a key role in
   % primary production. 
   % % That would be rather interesting as to our knowledge, it is 
   % Cyanobacteria that usually play this role could not do so in our case 
   % as high salinity level were found even in the top leyer of the mats. 
   Moreover, anaplerotic reactions were identified in high abundances across the samples.
   It is commonly known that anaplerotic reactions play a key role 
   in replenishing the intermediates of the TCA cycle~\citep{owen2002key},
   allowing microbial growth 
   when there is only a certain
   carbohydrate available~\citep{choi_distinct_2016}, indicating that sunlight 
   is actually the only energy source of the system. 

   % Furthermore, it has been demonstrated that seasonality affects mat communities to a great extent
   % \citep{}
   % import of reduced substances and periods of reduced salinity are required, 
   % to allow the occurrence of oxygenic photosynthesis (Meier et al. 2021); 
   % in our study site this occurs in winter where evaporation is not as strong as in the summer, 
   % which combined with the increased precipitation, 
   % lowers the salinity of the marsh. 

   % During winter months, both the salt crust and the layering of the microbial mat disappears, 
   % as in Cardoso et al. (2019), and it seems that this temporal change and seasonal development 
   % of the microbial mats under study is the necessary element for the survival of the microorganisms.

   % The affects of  
   % As discussed in Chapter~\ref{} 
   % \citep{cardoso_seasonal_2019}
   % Seasonality affects microbial mat community structure and functions
   % \ref{swamp:discussion}


\section{Future perspectives: more holistic approaches are essential to uncover the underlying mechanisms governing microbial communities}
\label{chap:fut-work}

   Aim of this PhD was to enhance the analysis of microbiome data from a bioinformatics-point of view
   and to implement such analyses to investigate life in extreme cases. 
   As already discussed, HTS methods come up with several challenges and 
   approaches such as PEMA (see Chapter~\ref{publ:pema}~\citep{zafeiropoulos2020pema}) and 
   DARN (see Chapter~\ref{publ:darn}~\citep{zafeiropoulos2021dark}) can benefit the community 
   in terms of fine parameter tuning and easy-to-use analysis and 
   quality checks for non-target taxa correspondingly. 
   Apparently, there is still a great number of issues need to be addressed.
   In case of amplicon studies, abundance estimation of the identified taxa has been crucial.
   \citeauthor{gloor2017microbiome} in their study in \citeyear{gloor2017microbiome} 
   claimed that it is the nature of the microbiome data that does not allow them to be anything else but compositional. 
   However, several studies have implemented approaches to retrieve 
   absolute abundances from amplicon data, e.g.~\citep{kim2021measuring, zemb2020absolute}.
   On top of that, long-read sequencing technologies have been improved radically, 
   allowing quality sequencing of the complete marker and not just of a certain part of it. 
   Therefore, approaches such as the Unique Molecular Identifiers (UMIs)~\citep{hiatt2010parallel} 
   need to be considered and benchmarked. 
   Yet, as discussed in~\citep{karst2021high}  
   by using paired UMIs, certain issues that characterise amplicon studies 
   such as chimeras and degree GC~\citep{benita2003regionalized} ease; 
   however, long-range PCR issues, 
   % such as primer bias, off-target products and an upper limit to amplifiable target length 
   lead to further challenges. 
   Further improvement of the bioinformatics analysis of the data provided from both these technologies
   can provide more quantitave microbiome data; a milestone for microbial ecology. 

   As already discussed, data integration is essential in 
   exploiting both the data and the so-far knowledge. 
   Approaches such as PREGO (see Chapter~\ref{cha:prego}~\citep{zafeiropoulos_prego_2022}) 
   will not reveal their true potential unless the community embrace a series of standards and 
   metadata protocols. 
   Thus, it is essential both to develop such checklists 
   but also to convince and train the community to use them. 
   PREGO-like approaches could benefit a lot from multiomics datasets 
   as well as by integrating information included in GEMs.
   We are now in a position when we can imagine (and why not, start implementing)
   of systems where a species will not be a node in a network, 
   but a complete network within the one of the community it belongs to.
   Moreover, to infer microbe - microbe associations and/or interactions,
   the incorporation of phenotypical data 
   such as pH values, optimal temperatures etc. to such networks, 
   is essential. 
   Resources such as FAPROTAX~\citep*{louca2016decoupling}, PhenDB~\citep{feldbauer2015prediction}
   and BugBase~\citep{Ward133462} provide great input for such a task. 

   Metagenomics and the rest of the 'omics technologies have turned the page on microbial ecology studies. 
   However, to address questions such as the seasonality effects on the community structure 
   and its functioning 
   (see Section~\ref{swamp:discussion} and Conclusion~\ref{conlc:mats}) 
   requires the thorough investigation of the dynamics of the community 
   and of the occurying processes within each of them 
   as the environmental conditions change,
   as well as the interactions among the species and their environment.
   As discussed by~\cite{bajic2020ecology} 
   \textit{"a combination of quantitative high - throughput experiments and predictive metabolic models 
   can help us map the genotype - phenotype map of microbial metabolic strategies}. 
   Further technologies, such as Raman micro-spectroscopy~\citep{jing2018raman}, can also be of great use to this end. 
   According to~\citeauthor{bajic2020ecology} 
   the prediction of such strategies will also provide great insight 
   on the evolvability of metabolic decisions 
   and will shed light on how these decisions affect
   microbial coexistence in the communities.
   % The software developed in the framework of the PhD can benefit such approaches, 
   % either by improving HTS data analysis, 
   % or by enhancing their exploitation or with novel predictive algorithms.
   % Apparently, for each of these fields, there are still several challenges that need to be addressed. 
   Therefore, HTS approaches and
   metabolic modeling at the community level build a promising framework to this end.
   Sampling (see~\ref{chap:dingo}~\citep{chalki2021SoCG})
   the flux space of such models
   will benefit microbial interactions inference to a great extent 
   and will provide essential insight
   in the study of the 
   mechanisms that govern real-world microbial assemblages.
   As the steady-state assumption does not consider kinetics or regulatory events, 
   the integration of machine learning approaches 
   can enhance this framework even further~\citep{sahu2021advances}.


% ---------------------------------------------

% Eco-evolutionary dynamics of complex social strategies in microbial communities~\citep{harrington2014eco}
% sediments are more phylogenetically diverse than any other environment type.   lozupone2007global

% Flux sampling as the future of microbial interaction inference 
% along with techniques such Raman spectometry etc.


